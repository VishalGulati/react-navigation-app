(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{19:function(e,t,n){e.exports=n(54)},26:function(e,t,n){},27:function(e,t,n){},28:function(e,t,n){},29:function(e,t,n){},30:function(e,t,n){},31:function(e,t,n){},32:function(e,t,n){},33:function(e,t,n){},53:function(e,t,n){},54:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(16),s=n.n(r),i=(n(25),n(26),n(27),n(28),function(){return o.a.createElement("header",null,"React Navigation App")}),c=n(9),u=n(7),l=n(2),p=n(3),d=n(5),m=n(4),h=n(6),f=(n(29),n(30),o.a.createContext({updateLocation:function(){},resetPending:!1,resetComplete:function(){}})),g=(n(31),function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(d.a)(this,Object(m.a)(t).call(this,e))).handlePlaceChanged=function(){var e=n.autocomplete.getPlace();e&&e.geometry&&(n.context.updateLocation(n.props.inputId,e.geometry.location),n.setState({isDirty:!0}))},n.resetField=function(){n.autocompleteInput.current.value="",n.context.updateLocation(n.props.inputId,""),n.setState({isDirty:!1})},n.autocompleteInput=o.a.createRef(),n.autocomplete=null,n.state={isDirty:!1},n}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentDidUpdate",value:function(){this.context.resetPending&&(this.resetField(),this.context.resetComplete())}},{key:"componentDidMount",value:function(){this.autocomplete=new window.google.maps.places.Autocomplete(this.autocompleteInput.current,{types:["geocode"]}),this.autocomplete.addListener("place_changed",this.handlePlaceChanged)}},{key:"render",value:function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement("input",{type:"text",ref:this.autocompleteInput,className:"form-control autocomplete-input",id:this.props.inputId,placeholder:"Enter a location"}),this.state.isDirty&&o.a.createElement("span",{className:"cross-icon",onClick:this.resetField},"X"))}}]),t}(a.Component));g.contextType=f;var y=g,b=function(e){return o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{htmlFor:e.inputId},e.label),o.a.createElement(y,{inputId:e.inputId}))},v=(n(32),function(e){var t=e.message,n=e.messageType;return t?o.a.createElement("p",{className:"message-container "+("error"===n?"error":"")},t):null}),w=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(o)))).resetForm=function(){n.myFormRef.reset(),n.props.handleReset()},n.getBtnLabel=function(){return n.props.isLoading?"Loading...":n.props.isDirty?"Re-Submit":"Submit"},n}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"col-xs-12 col-md-4 left-panel"},o.a.createElement("form",{onSubmit:this.props.handleSubmit,ref:function(t){return e.myFormRef=t}},o.a.createElement(b,{inputId:"start",label:"Starting location"}),o.a.createElement(b,{inputId:"drop",label:"Drop-off point"}),o.a.createElement(v,{message:this.props.message,messageType:this.props.messageType}),o.a.createElement("button",{type:"button",className:"btn btn-primary lp-btn",disabled:this.props.isLoading,onClick:this.props.handleSubmit},this.getBtnLabel()),o.a.createElement("button",{type:"button",className:"btn btn-secondary lp-btn",onClick:this.resetForm},"Reset")))}}]),t}(a.Component),E=n(18),S=(n(33),function(e,t){return new window.google.maps.LatLng(e,t)}),R=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(o)))).showDefaultPosition=function(){n.directionsService=new window.google.maps.DirectionsService,n.directionsDisplay=new window.google.maps.DirectionsRenderer,n.map=new window.google.maps.Map(n.mapWrapper,{center:{lat:51.509865,lng:-.118092},zoom:12,mapTypeId:"roadmap"})},n.diaplayRoute=function(){n.directionsDisplay.setMap(n.map);var e=Object(E.a)(n.props.route),t=e.shift(),a=e.pop(),o=e.map(function(e){return{location:S(e[0],e[1]),stopover:!0}});n.directionsService.route({origin:S(t[0],t[1]),destination:S(a[0],a[1]),waypoints:o,optimizeWaypoints:!0,travelMode:"DRIVING"},function(e,t){"OK"===t?n.directionsDisplay.setDirections(e):window.alert("Directions request failed with status: "+t)})},n.resetMap=function(){n.directionsDisplay.setMap(null)},n}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentDidUpdate",value:function(e){this.props.showRoute?this.diaplayRoute():this.resetMap()}},{key:"componentDidMount",value:function(){this.showDefaultPosition()}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"col-xs-12 col-md-8"},o.a.createElement("div",{id:"googleMap",ref:function(t){return e.mapWrapper=t}}))}}]),t}(a.Component),k=1,D={start:"",drop:"",message:"",messageType:"",mapLoaded:!1,resetPending:!1,showRoute:!1,route:null,isLoading:!1,isDirty:!1,retryCounter:k},O={serviceError:"Something went wrong! Please try again in some time.",uiValidationError:"Both starting location and drop-off point are mandatory!",appNotLoaded:"Failed to load app. Please make sure Google maps API key is added in .env file.",retryFailure:"Server did not respond even on retry. Please try again in some time"},j={success:"success",progress:"in progress",failure:"failure"},C=n(17),I={submit:"route",getRoute:"route/{token}"},M=n.n(C).a.create({baseURL:"https://mock-api.dev.lalamove.com"}),L={getReq:function(e){return M.get(e)},postReq:function(e,t){return M.post(e,t)}},N=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(d.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(e,t){n.setState(Object(u.a)({},e,t))},n.getCords=function(e){return[e.lat,e.lng]},n.checkForUnsuccessfulMsg=function(e){switch(e.data.status){case j.success:return"";case j.failure:return e.data.error;case j.progress:return O.retryFailure;default:return e.data.status}},n.setMessageInState=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";n.setState({message:e,messageType:t,isLoading:!1,isDirty:!0})},n.makeRequestForRoute=function(e){L.getReq(e).then(function(t){if(t.data.status===j.progress&&n.state.retryCounter>0)return n.setState(function(e){return{retryCounter:e.retryCounter-1}}),n.makeRequestForRoute(e);var a=n.checkForUnsuccessfulMsg(t);if(a)n.setMessageInState(a,"error");else{var o=t.data,r=o.total_distance,s=o.total_time;n.setMessageInState("total distance: "+r+" \ntotal time: "+s),n.setState({showRoute:!0,route:t.data.path})}}).catch(function(e){n.setMessageInState(O.serviceError,"error")})},n.makeRequestForToken=function(e,t){L.postReq(I.submit,{origin:e,destination:t}).then(function(e){var t=e&&e.data&&e.data.token,a=I.getRoute.replace("{token}",t);n.makeRequestForRoute(a)}).catch(function(e){n.setMessageInState(O.serviceError,"error")})},n.handleSubmit=function(e){e.preventDefault(),n.setState({isLoading:!0,message:"",messageType:"",showRoute:!1,route:null,retryCounter:k});var t=n.state,a=t.start,o=t.drop;if(a&&o){var r=n.getCords(JSON.parse(JSON.stringify(a))),s=n.getCords(JSON.parse(JSON.stringify(o)));n.makeRequestForToken(r,s)}else n.setMessageInState(O.uiValidationError,"error")},n.resetDone=function(){n.setState({resetPending:!1})},n.handleReset=function(e){n.setState(Object(c.a)({},D,{resetPending:!0,mapLoaded:!0}))},n.initMap=function(){n.setState({mapLoaded:!0})},n.state=Object(c.a)({},D),n}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){window.initMap=this.initMap;var e="https://maps.googleapis.com/maps/api/js?key=AIzaSyD2D0r1DXCw-EMAB1xTlc4SFnsN5z7CGx4";window.loadJS("".concat(e,"&libraries=places&callback=initMap"))}},{key:"render",value:function(){return o.a.createElement("div",{className:"app-body-container"},this.state.mapLoaded?o.a.createElement("div",{className:"row"},o.a.createElement(f.Provider,{value:{updateLocation:this.handleChange,resetPending:this.state.resetPending,resetComplete:this.resetDone}},o.a.createElement(w,Object.assign({handleSubmit:this.handleSubmit,handleReset:this.handleReset},this.state))),o.a.createElement(R,{showRoute:this.state.showRoute,route:this.state.route})):o.a.createElement("h1",{className:"error"},O.appNotLoaded))}}]),t}(a.Component),F=(n(53),function(){return o.a.createElement("footer",null,"Designed and Coded by Vishal Gulati - \xa9 2019")}),P=function(){return o.a.createElement("div",{className:"App"},o.a.createElement(i,null),o.a.createElement(N,null),o.a.createElement(F,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(o.a.createElement(P,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[19,1,2]]]);
//# sourceMappingURL=main.ea40f2df.chunk.js.map