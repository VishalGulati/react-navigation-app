(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{19:function(e,t,n){e.exports=n(54)},26:function(e,t,n){},27:function(e,t,n){},28:function(e,t,n){},29:function(e,t,n){},30:function(e,t,n){},31:function(e,t,n){},32:function(e,t,n){},33:function(e,t,n){},53:function(e,t,n){},54:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),s=n(16),i=n.n(s),r=(n(25),n(26),n(27),n(28),function(){return o.a.createElement("header",null,"React Navigation App")}),c=n(9),u=n(7),l=n(2),p=n(3),d=n(5),m=n(4),h=n(6),g=(n(29),n(30),o.a.createContext({mapLoaded:!1,updateLocation:function(){}})),f=(n(31),function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(d.a)(this,Object(m.a)(t).call(this,e))).handlePlaceChanged=function(){var e=n.autocomplete.getPlace();e&&e.geometry&&(n.context.updateLocation(n.props.inputId,e.geometry.location),n.setState({isDirty:!0}))},n.resetField=function(){n.autocompleteInput.current.value="",n.context.updateLocation(n.props.inputId,""),n.setState({isDirty:!1})},n.autocompleteInput=o.a.createRef(),n.autocomplete=null,n.state={isDirty:!1},n}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentDidUpdate",value:function(){this.context.mapLoaded&&(this.autocomplete=new window.google.maps.places.Autocomplete(this.autocompleteInput.current,{types:["geocode"]}),this.autocomplete.addListener("place_changed",this.handlePlaceChanged)),this.context.resetPending&&this.resetField()}},{key:"render",value:function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement("input",{type:"text",ref:this.autocompleteInput,className:"form-control autocomplete-input",id:this.props.inputId,placeholder:"Enter a location"}),this.state.isDirty&&o.a.createElement("span",{className:"cross-icon",onClick:this.resetField},"X"))}}]),t}(a.Component));f.contextType=g;var b=f,y=function(e){return o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{htmlFor:e.inputId},e.label),o.a.createElement(b,{className:"form-control",inputId:e.inputId,mapLoaded:e.mapLoaded}))},v=(n(32),function(e){var t=e.message,n=e.messageType;return t?o.a.createElement("p",{className:"error"===n?"text-red":"",dangerouslySetInnerHTML:function(e){return{__html:e}}(t)}):null}),w=function(e){function t(){return Object(l.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentDidUpdate",value:function(){this.props.resetPending&&(this.myFormRef.reset(),this.props.resetDone())}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"col-xs-12 col-md-4 left-panel"},o.a.createElement("form",{onSubmit:this.props.handleSubmit,ref:function(t){return e.myFormRef=t}},o.a.createElement(y,{inputId:"start",label:"Starting location"}),o.a.createElement(y,{inputId:"drop",label:"Drop-off point"}),o.a.createElement(v,{message:this.props.message,messageType:this.props.messageType}),o.a.createElement("button",{type:"button",className:"btn btn-primary lp-btn",disabled:"Loading..."===this.props.submitBtnLabel,onClick:this.props.handleSubmit},this.props.submitBtnLabel),o.a.createElement("button",{type:"button",className:"btn btn-secondary lp-btn",onClick:this.props.handleReset},"Reset")))}}]),t}(a.Component),S=n(18),R=(n(33),function(e,t){return new window.google.maps.LatLng(e,t)}),E=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return(n=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(o)))).showDefaultPosition=function(){n.directionsService=new window.google.maps.DirectionsService,n.directionsDisplay=new window.google.maps.DirectionsRenderer,n.map=new window.google.maps.Map(document.getElementById("googleMap"),{center:{lat:51.509865,lng:-.118092},zoom:12,mapTypeId:"roadmap"})},n.diaplayRoute=function(){n.directionsDisplay.setMap(n.map);var e=Object(S.a)(n.props.route),t=e.shift(),a=e.pop(),o=e.map(function(e){return{location:R(e[0],e[1]),stopover:!0}});n.directionsService.route({origin:R(t[0],t[1]),destination:R(a[0],a[1]),waypoints:o,optimizeWaypoints:!0,travelMode:"DRIVING"},function(e,t){"OK"===t&&n.directionsDisplay.setDirections(e)})},n.resetMap=function(){n.directionsDisplay.setMap(null)},n}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentDidUpdate",value:function(e){this.props.mapLoaded&&!e.mapLoaded&&this.showDefaultPosition(),this.props.showRoute?this.diaplayRoute():this.resetMap()}},{key:"render",value:function(){return o.a.createElement("div",{className:"col-xs-12 col-md-8"},o.a.createElement("div",{id:"googleMap"}))}}]),t}(a.Component),k={start:"",drop:"",message:"",messageType:"",mapLoaded:!1,resetPending:!1,showRoute:!1,route:null,submitBtnLabel:"Submit"},L=n(17),O={submit:"route",getRoute:"route/{token}"},D=n.n(L).a.create({baseURL:"https://mock-api.dev.lalamove.com"}),j={getReq:function(e){return D.get(e)},postReq:function(e,t){return D.post(e,t)}},I=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(d.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(e,t){n.setState(Object(u.a)({},e,t))},n.getCords=function(e){return[e.lat,e.lng]},n.checkForUnsuccessfulMsg=function(e){switch(e.data.status){case"success":return"";case"failure":return e.data.error;default:return e.data.status}},n.setMessageInState=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";n.setState({message:e,messageType:t,submitBtnLabel:"Re-Submit"})},n.makeRequestForRoute=function(e){j.getReq(e).then(function(t){if("in progress"===t.data.status)return n.makeRequestForRoute(e);var a=n.checkForUnsuccessfulMsg(t);if(a)n.setMessageInState("Server responded with: "+a,"error");else{var o=t.data,s=o.total_distance,i=o.total_time;n.setMessageInState("total distance: "+s+" <br/> total time: "+i),n.setState({submitBtnLabel:"Re-Submit",showRoute:!0,route:t.data.path})}}).catch(function(e){n.setMessageInState("Something went wrong! Please try again in some time.","error")})},n.makeRequestForToken=function(e,t){j.postReq(O.submit,{origin:e,destination:t}).then(function(e){var t=e&&e.data&&e.data.token,a=O.getRoute.replace("{token}",t);n.makeRequestForRoute(a)}).catch(function(e){n.setMessageInState("Something went wrong! Please try again in some time.","error")})},n.handleSubmit=function(e){e.preventDefault(),n.setState({submitBtnLabel:"Loading...",message:"",messageType:"",showRoute:!1,route:null});var t=n.state,a=t.start,o=t.drop;if(a&&o){var s=n.getCords(JSON.parse(JSON.stringify(n.state.start))),i=n.getCords(JSON.parse(JSON.stringify(n.state.drop)));n.makeRequestForToken(s,i)}else n.setMessageInState("Both starting location and drop-off point are mandatory!","error")},n.resetDone=function(){n.setState({resetPending:!1})},n.handleReset=function(e){n.setState(Object(c.a)({},k,{resetPending:!0,mapLoaded:!0}))},n.initMap=function(){n.setState({mapLoaded:!0})},n.state=Object(c.a)({},k),n}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){window.initMap=this.initMap,window.loadJS("".concat("https://maps.googleapis.com/maps/api/js?key=AIzaSyD2D0r1DXCw-EMAB1xTlc4SFnsN5z7CGx4","&libraries=places&callback=initMap"))}},{key:"render",value:function(){return o.a.createElement("div",{className:"app-body-container"},o.a.createElement("div",{className:"row"},o.a.createElement(g.Provider,{value:{mapLoaded:this.state.mapLoaded,updateLocation:this.handleChange,resetPending:this.state.resetPending}},o.a.createElement(w,Object.assign({handleSubmit:this.handleSubmit,handleReset:this.handleReset,resetDone:this.resetDone},this.state))),o.a.createElement(E,{mapLoaded:this.state.mapLoaded,showRoute:this.state.showRoute,resetPending:this.state.resetPending,route:this.state.route})))}}]),t}(a.Component),M=(n(53),function(){return o.a.createElement("footer",null,"Designed and Coded by Vishal Gulati - \xa9 2019")}),N=function(){return o.a.createElement("div",{className:"App"},o.a.createElement(r,null),o.a.createElement(I,null),o.a.createElement(M,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(N,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[19,1,2]]]);
//# sourceMappingURL=main.851401d8.chunk.js.map